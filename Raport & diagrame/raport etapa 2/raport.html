<!doctype html>
<html lang="ro">

<head>
    <meta charset="utf-8">
    <title>Pamaf (pac-man @ fii)</title>
    <link rel="stylesheet" href="../raport/raport.css">
</head>

<body prefix="schema: http://schema.org">
    <article typeof="schema:ScholarlyArticle" resource="#">
        <header>
            <h1 property="schema:name"> Pamaf (pac-man @ fii)
            </h1>
        </header>
        <div role="contentinfo">
            <dl>
                <dt>Autori</dt>
                <dd>
                    Gabriel Schițcu, Adriana Ursachi
                </dd>
            </dl>
        </div>
        <section typeof="sa:Subcategorii" id="cuprins">
            <h2>Cuprins</h2>
            <aside typeof="schema:WPSideBar">
                <ul>
                    <li>
                        <a href="#interactiune-utilizator">1. Maniera de interacţiune cu utilizatorul</a>
                    </li>
                    <li>
                        <a href="#model-api-stocare">2. Modelul datelor, API-uri externe, soluţii de stocare</a>
                    </li>
                    <li>
                        <a href="#functionalitate">3. Modul de funcționare</a>
                    </li>

                </ul>
            </aside>
        </section>
        <section id="interactiune-utilizator">
            <h2>1. Maniera de interacţiune cu utilizatorul</h2>
            <blockquote>
                <h3> Utilizatori care nu se loghează </h3>
                <p>
                    Deoarece nu putem impune unui vizitator al paginii să se logheze pentru a juca, acesta va avea acces la joc ca și jucător de tip 
                    guest, fără ca scorul
                    său să fie salvat. Totuși, acesta poate selecta anul universitar (1,2 sau 3), acest lucru modificând dificultatea jocului.
                </p>
            </blockquote>
            <blockquote>
                <h3> Utlizatori logați </h3>
                <p>
                    Autentificarea se va face pe baza contului de facebook, iar avatarul jucătorului va fi reprezentat de poza acestuia de profil.
                    Meniul paginii conține 3 elemente: pagina de home, pagina care conține jocul propriu-zis și o pagină
                    de help care conține regulile jocului.
                </p>
                <p>
                    După cum spuneam, labirintul va fi reprezentat de harta corpului C, iar în funcţie de nivelul de studiu al jucătorului(utilizatorul 
                    are posibilitatea de a-și alege oricare dintre cei 3 ani universitari), acesta
                    va fi plasat la un anumit etaj (fiecare clasa de la un etaj reprezintă un nivel generat aleator). Inițial, acesta va avea 3 vieți. Scopul
                    jucătorului este de a trece toate nivelele și de a coborî etajele până ajunge la ieșirea din facultate.
                    <br>
                    Un utilizator își poate schimba anul universitar în orice moment, fără să piardă progresul jocului din anul pe care îl avea
                    selectat precedent. Asta înseamnă că un utilizator va avea accesul la 3 salvări de joc, câte una pentru fiecare an universitar.
                </p>
                <p>
                    Pentru a face experiența mai interesantă, fantomele din joc vor avea înfăţişarea unor profesori ai Facultății de Informatică,
                    sau a unor prieteni din contul de facebook al jucătorului.
                    <br> Vor exista și anumite bonusuri în cadrul nivelelor care vor crește semnificativ scorul, și care vor
                    da șansa jucătorului să vâneze la rândul său fantomele.
                </p>
                <p>
                    Atunci când un utilizator își pierde toate viețile, acesta va fi întrebat dacă dorește ca scorul obținut să îi fie salvat, iar sesiunea
                    de joc va fi marcată ca și terminată. Același lucru se va întâmpla și atunci când utilizatorul câștigă.
                </p>
            </blockquote>

            <figure typeof="sa:Image7">
                <img class="imagine" src="../raport/img/score.png">
                <figcaption>
                    Jucătorul va putea concura cu prietenii săi.
                </figcaption>
            </figure>

        </section>

        <section id="model-api-stocare">
                <h2>2. API-uri externe, modelul datelor și soluţii de stocare</h2>
                <blockquote>
                    <h3> Facebook API </h3>
                    <p>
                        Vom folosi API-ul oferit de Facebook, pentru a-i oferi utilizatorului posibilitatea de a se loga pe pagină cu ajutorul
                        contului său din această platformă și de a concura cu prietenii săi. 
                    </p>
                    <p>
                        Concret, o să înregistrăm aplicația la <a href = "https://developers.facebook.com">https://developers.facebook.com</a>
                        pentru a putea utiliza API-ul. Ne vom folosi de Facebook Login pentru a face logarea pe site și îi vom cere utilizatorului
                        următoarele permisiuni:
                    </p>
                    <ul>
                        <li>user_photos - pentru a putea folosi poza acestuia la avatarul din joc</li>
                        <li>user_friends - pentru a accesa lista de prieteni înregistrați în aplicație ai acestuia pentru o experiență completă a jocului</li>
                    </ul>
                    
                </blockquote>

                <blockquote>
                    <h3>Local Storage</h3>
                    <p>
                        Pentru stocarea progresului și a diferitelor informații folositoare despre utilizator am decis să
                        folosim API-ul pus la dispoziție de HTML, Local Web Storage. Nu am recurs la cookie-uri deoarece ar
                        îngreuna cererile spre server dar și pentru că această modalitate de stocarea a informațiilor este mai
                        sigură, multe date putând fi stocate local fără a afecta performanța site-ului.
                    </p>
                    <p>
                        În local storage am decis să stocăm pentru fiecare utilizator înregistrat detalii referitoare la datele de autentificare,
                        nivelul la care se află acesta, respectiv scorul său.
                    </p>
                </blockquote>

                <blockquote>
                    <h3>Entity Framework Core cu baza de date în Microsoft SQL</h3>
                        <p>
                            Entity Framework Core este un framework "Object/Relational Mapping (O/RM)" care oferă un mecanism automat de accesare 
                            și stocare a datelor în baza de date. Folosind acest framework putem reprezenta entitățile stocate în baza de date drept
							obiecte, ceea ce implică o definire mult mai ușoară a relațiilor dintre acestea și facilitează modificarea ulterioară a
							entităților în modul caracteristic POO.
						</p>
						<p>	
                            Baza de date a fost creată prin aproach-ul CodeFirst. Asta presupune scrierea
							tuturor modelelor sub formă de clase, ca mai apoi, Entity Framework Core să genereze DB-ul pe baza acestora. Acest aproach
							conferă simplitate, viteză și un mediu POO cunoscut. Pentru anumite modificări a reprezentării entităților ne vom folosi
							de migrații a bazei de date.
                        </p>
                        <p>
                            Baza de date va conține tabelele cu câmpurile:
                        </p>
                        <ul>
                            <li>Users: Id, Username, FacebookName</li>
                            <li>GameDatas: Id, User, Year, Level, Score, DateModified, IsFinished</li>
                            <li>Scores: Score, User, Date, Year</li>       
                        </ul>
                        
                </blockquote>

                <blockquote>
                    <h3>API-ul aplicației</h3>
                    <p>
                        Pentru acest API ne vom folosi de .NET Core și va fi utilizat pentru a-i asigura utilizatorului o autentificare interactivă,
                        adică acesta va avea progresul din cadrul jocului salvat. De asemenea, va fi folosit pentru a face rost de date legate de utilizatori 
                        (high score, ultimul nivel jucat, etc.) și pentru a stoca anumite resurse folosite pentru crearea jocului (resurse 
                        json care reprezintă planul corpului C,
                        resurse json cu bucăți de hartă ce vor fi folosite de către aplicația client pentru a genera random nivele).
                    </p>
                </blockquote>

                <blockquote>
                    <h3>Microdate</h3>
                    <p>
                        Ne-am folosit de scheme de microdate HTML5 pentru a specifica structurarea datelor, acestea fiind perechi de proprietăți
                        nume—valoare „scufundate” în HTML. Crearea unei astfel de date se face prin atributul "itemscope", care stabilește 
                        și domeniul de vizibilitate al microdatei, iar specificarea unei proprietăți se face prin atributul "itemprop".
                    </p>
                    <p>
                        Am folosit colecția de vocabulare (scheme de date) oferită de <a href="https://schema.org/">schema.org</a>, în special de tipul
                        de date <a href="https://schema.org/Game">Game</a>, folosind proprietățile: gameItem, gameLocation, quest, contributor, description
                        pentru a specifica unele din funcționalitățile jocului, respectiv pentru a sublinia anumite detalii.
                    </p>
                </blockquote>

        </section>

        <section id="functionalitate">
            <h2>3. Modul de funcționare</h2>
            <blockquote>
                <h3>Login</h3>
                <p>
                    Atunci când un utilizator se loghează cu ajutorul platformei Facebook, aplicația îl va caută pe acesta în baza de date. 
                    Dacă acest utilizator este nou, i se va crea o înregistrare în tabela de useri
                    și i se vor inițializa atribute în Local Storage, iar dacă utilizatorul nu este nou, atunci aplicația va face un query la baza de date pentru a face rost de 
                    ultima sesiune de joc a acestuia.
                </p>  
            </blockquote>

            <blockquote>
                <h3>Game</h3>
                <p>
                    Atunci când utilizatorul intră pe pagina "Game", aplicația va accesa Local Storage pentru a face rost de id-ul utilizatorului și de anul universitar selectat de acesta.
                    Avand aceste date, se va face un request la API pentru a primi ultima sesiune de joc neterminată pentru utilizatorul respectiv în anul ales. Dacă nu există o astfel de 
                    sesiune se va crea una. Dacă totuși există, atunci aplicația va știi numărul de vieți rămase, level-urile terminate, respectiv scorul acumulat până atunci și va inițializa 
                    corect clasa Game.
                </p>
                <p>
                    În acest moment utilizatorul poate naviga printr-o hartă 2D a corpului C, intrarea pe o ușă reprezentând începerea unui nivel. Pentru fiecare nivel
                    aplicația va genera aleator o hartă(prin clasa MapGenerator) care va fi populată de către 4 inamici și de catre jucător. Aceste variabile vor fi mai apoi transmise
                    către clasa "LevelRunner" care va prelua interfața grafică și va rula jocul "Pamaf" cu parametrii corecți.
                </p>
                <p>
                    Când jucătorul pierde/câștigă, clasa "LevelRunner" va
                    notifica clasa "Game" în legatură cu cele întâmplate, iar aceasta va reacționa corespunzător.
                </p>
            </blockquote>

            <blockquote>
                <h3>Statistici</h3>
                <p>
                    Paginile de statistici pentru jucător, cât și pentru leaderboard vor fi create prin request-uri simple la API.
                    Acesta va transmite resursele necesare ce vor fi procesate de către aplicația client.
                </p>
            </blockquote>
        </section>
    </article>
</body>

</html>